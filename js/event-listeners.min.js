function setupEventListeners(){window.addEventListener("resize",(()=>{resize(),resetObjects()})),fsBtn.addEventListener("click",tryFullscreen),startSinglePlayerBtn.addEventListener("click",(()=>startGame("singlePlayer"))),startTwoPlayerBtn.addEventListener("click",(()=>startGame("twoPlayer")));const e=document.getElementById("startAiVsAiBtn");e&&e.addEventListener("click",(()=>startGame("ai-vs-ai"))),pauseBtn.addEventListener("click",togglePause),resetBtn.addEventListener("click",(()=>location.reload()));const t=document.getElementById("saveAiBtn"),n=document.getElementById("loadAiBtn"),a=document.getElementById("loadAiModal"),d=document.getElementById("selectFilesBtn"),s=document.getElementById("confirmLoadBtn"),i=document.getElementById("cancelLoadBtn"),o=document.getElementById("modelUploader"),l=document.getElementById("fileStatus");let c=[];function r(){const e=c.some((e=>e.name.endsWith(".json"))),t=c.some((e=>e.name.endsWith(".bin"))),n=c.some((e=>e.name.endsWith(".txt"))),a=e&&t&&n;l.textContent=a?`${c.length} فایل انتخاب شد ✔️`:"لطفاً ۳ فایل مدل را انتخاب کنید ❌",l.style.color=a?"#02ffa0":"#ff6b6b",s.disabled=!a,s.style.opacity=a?1:.5}t&&t.addEventListener("click",(()=>{"singlePlayer"===state.gameMode||"ai-vs-ai"===state.gameMode?rlAgent.saveModel():showMessage("فقط در حالت تک‌نفره یا هوش مصنوعی در مقابل ربات!","orange")})),n&&n.addEventListener("click",(()=>{a.style.display="flex",c=[],o.value="",r()})),d.addEventListener("click",(()=>o.click())),o.addEventListener("change",(e=>{c=Array.from(e.target.files),r()})),s.addEventListener("click",(async()=>{await rlAgent.loadModel(c)&&(rlAgent.updateTargetModel(targetAgent.model),a.style.display="none")})),i.addEventListener("click",(()=>{a.style.display="none"})),window.addEventListener("keydown",(e=>{"Escape"!==e.key&&"p"!==e.key.toLowerCase()||togglePause(),keys[e.key.toLowerCase()]=!0,keys[e.code]=!0,handleShootKeydown(e)})),window.addEventListener("keyup",(e=>{keys[e.key.toLowerCase()]=!1,keys[e.code]=!1})),canvas.addEventListener("touchstart",(e=>{e.preventDefault();for(const t of e.changedTouches)activeTouch[t.identifier]={id:t.identifier}}),{passive:!1}),canvas.addEventListener("touchmove",(e=>{if(e.preventDefault(),!state.running||state.paused)return;const t=canvas.getBoundingClientRect();for(const n of e.changedTouches){const e={x:n.clientX-t.left,y:n.clientY-t.top},a=distance(e,paddleA),d=distance(e,paddleB);"twoPlayer"===state.gameMode&&a<d?(paddleA.x=e.x,paddleA.y=e.y):(paddleB.x=e.x,paddleB.y=e.y)}}),{passive:!1}),window.addEventListener("orientationchange",(()=>{resize(),resetObjects()})),document.addEventListener("selectstart",(e=>e.preventDefault()))}